



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A hands-on workshop to learn about a variety of AWS identity topics.">
      
      
        <link rel="canonical" href="https://identity-round-robin.awssecworkshops.com/permission-boundaries-advanced/build/">
      
      
        <meta name="author" content="aws-security-workshops@amazon.com">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/aws-favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Build Phase - Identity Round Robin</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/custom.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#permissions-boundaries-workshop-build-phase" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <!--
  Copyright (c) 2016-2018 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->
<header class="md-header" data-md-component="header">

    <!-- Top-level navigation -->
    <nav class="md-header-nav md-grid">
      <div class="md-flex">
  
        <!-- Link to home -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://aws.amazon.com/"
              title="Amazon Web Services"
              class="md-header-nav__button md-logo">
            
              <img src="../../assets/images/aws_smile_logo.png" width="40" height="24" />
            
          </a>
        </div>
  
        <!-- Button to toggle drawer -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button"
              for="__drawer"></label>
        </div>
  
        <!-- Header title -->
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title"
              data-md-component="title">
            
              
                <span class="md-header-nav__topic">
                  Identity Round Robin
                </span>
                <span class="md-header-nav__topic">
                  Build Phase
                </span>
              
            
          </div>
        </div>
  
        <!-- Button to open search dialogue -->
        <div class="md-flex__cell md-flex__cell--shrink">
          
            
              <label class="md-icon md-icon--search md-header-nav__button"
                  for="__search"></label>
  
              <!-- Search interface -->
              
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
            
          
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-flex__ellipsis md-header-nav__lang">
                <div class="md-lang-drop">
                    <button onclick="window.location.href='https://awssecworkshops.com/'" class="md-lang-dropbtn fa fa-home"></button>
                    <!--
                    <div id="mdDropMenu" class="md-dropdown-content">
                        <a href="#">JP</a>
                    </div>
                    -->
                </div>
            </div>
        </div>
  
        <!-- Repository containing source -->
        
          <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-header-nav__source">
              


  

<a href="https://github.com/aws-samples/aws-identity-round-robin-workshop/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/aws-identity-round-robin-workshop
  </div>
</a>
            </div>
          </div>
        
      </div>
    </nav>
  </header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Overview" class="md-tabs__link">
        Overview
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../serverless/" title="Serverless Identity" class="md-tabs__link">
          Serverless Identity
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../delegation/" title="Access Delegation" class="md-tabs__link">
          Access Delegation
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../permission-boundaries/" title="Permissions Boundaries - Basic" class="md-tabs__link">
          Permissions Boundaries - Basic
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../" title="Permissions Boundaries - Advanced" class="md-tabs__link md-tabs__link--active">
          Permissions Boundaries - Advanced
        </a>
      
    </li>
  

      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!--
  Copyright (c) 2016-2019 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Main navigation -->
<nav class="md-nav md-nav--primary" data-md-level="0">

  <!-- Site title -->
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://identity-round-robin.awssecworkshops.com/"
        title="Identity Round Robin" class="md-nav__button md-logo">
      
        <img src="../../assets/images/aws_smile_logo.png" width="48" height="48" />
      
    </a>
    Identity Round Robin
  </label>

  <!-- Repository containing source -->
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/aws-samples/aws-identity-round-robin-workshop/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/aws-identity-round-robin-workshop
  </div>
</a>
    </div>
  

  <!-- Render item list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Serverless Identity
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Serverless Identity
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../serverless/" title="Scenario" class="md-nav__link">
      Scenario
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../serverless/task1/" title="Task 1" class="md-nav__link">
      Task 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../serverless/task2/" title="Task 2" class="md-nav__link">
      Task 2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Access Delegation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Access Delegation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../delegation/" title="Scenario" class="md-nav__link">
      Scenario
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../delegation/build/" title="Build Phase" class="md-nav__link">
      Build Phase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../delegation/verify/" title="Verify Phase" class="md-nav__link">
      Verify Phase
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Permissions Boundaries - Basic
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Permissions Boundaries - Basic
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../permission-boundaries/" title="Scenario" class="md-nav__link">
      Scenario
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../permission-boundaries/build/" title="Build Phase" class="md-nav__link">
      Build Phase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../permission-boundaries/verify/" title="Verify Phase" class="md-nav__link">
      Verify Phase
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Permissions Boundaries - Advanced
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Permissions Boundaries - Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Scenario" class="md-nav__link">
      Scenario
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Build Phase
      </label>
    
    <a href="./" title="Build Phase" class="md-nav__link md-nav__link--active">
      Build Phase
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup-instructions" title="Setup Instructions" class="md-nav__link">
    Setup Instructions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-1-create-the-webadmins-role" title="Task 1 Create the webadmins role" class="md-nav__link">
    Task 1 Create the webadmins role
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-create-the-permissions-boundary-for-the-webadmins" title="Task 2 Create the permissions boundary for the webadmins" class="md-nav__link">
    Task 2 Create the permissions boundary for the webadmins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-create-the-permission-policy-for-the-webadmins" title="Task 3 Create the permission policy for the webadmins" class="md-nav__link">
    Task 3 Create the permission policy for the webadmins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-test-the-webadmins-permissions" title="Task 4 Test the webadmins permissions" class="md-nav__link">
    Task 4 Test the webadmins permissions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-gather-info-needed-for-the-verify-phase" title="Task 5 Gather info needed for the VERIFY phase" class="md-nav__link">
    Task 5 Gather info needed for the VERIFY phase
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../verify/" title="Verify Phase" class="md-nav__link">
      Verify Phase
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contribute/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup-instructions" title="Setup Instructions" class="md-nav__link">
    Setup Instructions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-1-create-the-webadmins-role" title="Task 1 Create the webadmins role" class="md-nav__link">
    Task 1 Create the webadmins role
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-create-the-permissions-boundary-for-the-webadmins" title="Task 2 Create the permissions boundary for the webadmins" class="md-nav__link">
    Task 2 Create the permissions boundary for the webadmins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-create-the-permission-policy-for-the-webadmins" title="Task 3 Create the permission policy for the webadmins" class="md-nav__link">
    Task 3 Create the permission policy for the webadmins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-test-the-webadmins-permissions" title="Task 4 Test the webadmins permissions" class="md-nav__link">
    Task 4 Test the webadmins permissions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-gather-info-needed-for-the-verify-phase" title="Task 5 Gather info needed for the VERIFY phase" class="md-nav__link">
    Task 5 Gather info needed for the VERIFY phase
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aws-samples/aws-identity-round-robin-workshop/edit/master/docs/permission-boundaries-advanced/build.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="permissions-boundaries-workshop-build-phase">Permissions boundaries workshop <small> Build phase </small></h1>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p><p style="font-size:16px;">
  Throughout the workshop, keep in mind where you need to replace <ACCOUNT_ID> with the correct Account ID, where you need to use pathing and also where you need to change the region (although if you are taking this as part of an AWS event, just use the already specified us-east-1.) Missing any of these items can result in problems and errors like <strong>"An error occurred (MalformedPolicyDocument) when calling the CreatePolicy operation: The policy failed legacy parsing"</strong>.
</p></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><p style="font-size:16px;">
  Tasks 1, 2 and 3 can be done independently if you are working in a team and want to divide up the tasks.
</p></p>
</div>
<h2 id="setup-instructions">Setup Instructions</h2>
<p>To setup your environment expand the appropriate choice from the following drop-downs, perform the tasks, and then move on to <strong>Task 1</strong></p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The CloudFormation stack will fail if you have either of the following S3 <strong>Block public access</strong> account options set to <strong>On</strong>: <strong>"Block public access to buckets and objects granted through new access control lists (ACLs)"</strong> or <strong>"Block public and cross-account access to buckets and objects through any public bucket policies"</strong>. You need to set both to <strong>Off</strong> before running the stack. The other options can be set to <strong>On</strong>.
<img alt="s3blockpublicaccess" src="../images/s3blockpublicaccess.png" /></p>
</div>
<details class="info"><summary>Click here if you're at an <em>AWS event</em> where the <em>Event Engine</em> is being used</summary><p><p style="font-size:20px;">
  <strong>Step 1</strong> : Retrieve temporary credentials from Event Engine
</p></p>
<ol>
<li>Navigate to the <a href="https://dashboard.eventengine.run" target="_blank">Event Engine dashboard</a></li>
<li>Enter your <strong>team hash</strong> code. </li>
<li>Click <strong>AWS Console</strong></li>
<li>Copy the <strong>export</strong> commmands under the <strong>Credentials</strong> section for the temporary credentials (you will need these in the next step.)</li>
</ol>
<p><p style="font-size:20px;">
  <strong>Step 2</strong> : Connect to the AWS Console via Event Engine and browse to the AWS Cloud9 IDE
</p>    </p>
<ol>
<li>Click <strong>Open Console</strong> from the Event Engine window</li>
<li>Navigate to the <a href="https://us-east-1.console.aws.amazon.com/cloud9/home" target="_blank">AWS Cloud9</a> console.</li>
<li>Click on <strong>Open IDE</strong> in the <code>workshop-environment</code> under <strong>Your environments</strong></li>
<li>Click the <strong>gear image</strong> icon in the upper right hand corner to open the Cloud9 Preferences. Scroll down in the settings, click on the <strong>AWS SETTINGS</strong> section and click the button next to <strong>AWS managed temporary credentials</strong> to disable this.</li>
<li>Now go to a Cloud9 terminal tab (tab title will start with the words <strong>bash</strong>). </li>
<li>Type <code>aws configure --profile default</code> hit enter. Hit enter until you get to the choice <strong>Default region name</strong> and type in <code>us-east-1</code>. Hit enter and then enter again to leave this menu.</li>
<li>Then create a file in the <code>~/.aws</code> directory named <code>credentials</code> and paste in the credentials you copied from the Event Engine. You will need to remove the word <strong>export</strong> from the start of each line. Add <code>[default]</code> before all these rows. You should end up with something that looks like this:<br>
[default]</br>
AWS_ACCESS_KEY_ID=ASIA<strong><em>_</em></strong>_</br>
AWS_SECRET_ACCESS_KEY=iZoD<strong><em>_</em></strong><strong><em>_</em></strong><strong><em>_</em></strong>__</br>
AWS_SESSION_TOKEN=FQoG<strong><em>_</em></strong><strong><em>_</em></strong><strong><em>_</em></strong><strong><em>_</em></strong><strong><em>_</em></strong><strong><em>_</em></strong>___</br></li>
<li>Now you can run commands from within the Cloud9 IDE using the temporary credentials from Event Engine. If you open a new tab you will need to paste in the credentials again.</li>
<li>Move on to <strong>Task 1</strong>.</li>
</ol>
</details>
<details class="info"><summary>Click here if you're at an <em>AWS event</em> and <em>AWS provided an account to you</em></summary><p><p style="font-size:20px;">
  <strong>Step 1</strong>: Login to the console and run the CloudFormation template
</p></p>
<p><strong>Console Login:</strong> Your team should have been given a piece of paper with a URL and credentials. This will allow you to login using AWS SSO. </p>
<p>After you login click <strong>AWS Account</strong> box, then click on the Account ID displayed below that (the red box in the image.) You should see a link below that for <strong>Management console</strong>. Click on that and you will be taken the AWS console. Make sure the region is set to US East 2 (Ohio).</p>
<p><strong> Click the <em>Deploy to AWS</em> button below to launch the CloudFormation stack. </strong></p>
<table>
<thead>
<tr>
<th>Region</th>
<th>Deploy</th>
</tr>
</thead>
<tbody>
<tr>
<td>US East 1 (Virginia)</td>
<td><a href="https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/new?stackName=Perm-Bound-Adv&templateURL=https://s3-us-west-2.amazonaws.com/sa-security-specialist-workshops-us-west-2/identity-workshop/permissionboundary/identity-workshop-web-admins-advanced.yaml" target="_blank"><img alt="Deploy in us-east-2" src="../images/deploy-to-aws.png" /></a></td>
</tr>
</tbody>
</table>
<ol>
<li>Click <strong>Next</strong> on the <strong>Select Template</strong> section.</li>
<li>Click <strong>Next</strong> on the <strong>Specify Details</strong> section (the stack name will be already filled - you can change it or leave it as is)</li>
<li>Click <strong>Next</strong> on the <strong>Options</strong> section.</li>
<li>Finally, acknowledge that the template will create IAM roles under <strong>Capabilities</strong> and click <strong>Create</strong>.</li>
<li>This will bring you back to the CloudFormation console. You can refresh the page to see the stack starting to create. Before moving on, make sure the stack shows <strong>CREATE_COMPLETE</strong>.</li>
</ol>
<p><p style="font-size:20px;">
  <strong>Step 2</strong> : Connect to the AWS Cloud9 IDE
</p></p>
<ol>
<li>Navigate to the <a href="https://us-east-2.console.aws.amazon.com/cloud9/home" target="_blank">AWS Cloud9</a> console.</li>
<li>Click on <strong>Open IDE</strong> in the <code>workshop-environment</code> under <strong>Your environments</strong></li>
<li>Click the <strong>gear</strong> icon in the upper right hand corner to open the Cloud9 Preferences. Scroll down in the settings, click on the <strong>AWS SETTINGS</strong> section and click the button next to <strong>AWS Managed Temporary Credentials</strong> to disable this.</li>
<li>Now go back to the AWS SSO tab (this should be the first tab you opened for the workshop). Click the <strong>command line or programmatic access</strong>. Click the section under <strong>Option 2</strong> to copy the credentials.</li>
<li>Go back to the Cloud9 environment. Type <code>aws configure</code> hit enter. Hit enter until you get to the choice <strong>Default region name</strong> and type in <code>us-east-2</code>. Hit enter and then enter again to leave this menu.</li>
<li>Then create a file in the <code>~/.aws</code> directory named <code>credentials</code> and paste in the credentials you copied from the SSO login page. Rename the profile to <code>default</code> (it will be named something similar to <strong>Account_ID_AdministratorAccess</strong> when you first paste it in)</li>
<li>Now you can run commands from within the Cloud9 IDE using the temporary credentials from AWS SSO. </li>
<li>Move on to <strong>Task 1</strong>.</li>
</ol>
</details>
<details class="info"><summary>Click here if you are <em>using your own AWS account</em> (whether you are at an AWS event, a separate event or online)</summary><p>Log in to your account however you would normally. You should use an IAM user or role with admin rights. </p>
<p><strong>CloudFormation:</strong> Launch the CloudFormation stack below to setup the environment:</p>
<table>
<thead>
<tr>
<th>Region</th>
<th>Deploy</th>
</tr>
</thead>
<tbody>
<tr>
<td>US East 1 (Virginia)</td>
<td><a href="https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/new?stackName=Perm-Bound-Adv&templateURL=https://s3-us-west-2.amazonaws.com/sa-security-specialist-workshops-us-west-2/identity-workshop/permissionboundary/identity-workshop-web-admins-advanced-solo.yaml" target="_blank"><img alt="Deploy in us-east-2" src="../images/deploy-to-aws.png" /></a></td>
</tr>
</tbody>
</table>
<ol>
<li>Click the <strong>Deploy to AWS</strong> button above.  This will automatically take you to the console to run the template.  </li>
<li>Click <strong>Next</strong> under the <strong>Create stack</strong> section.</li>
<li>Click <strong>Next</strong> under the <strong>Specify stack details</strong> section (the stack name will already be filled - you can leave the other options in Parameters at their default settings too)</li>
<li>Click <strong>Next</strong> under the <strong>Advanced options</strong> section.</li>
<li>Finally, acknowledge that the template will create IAM resources with custom names under <strong>Capabilities</strong> and click <strong>Create stack</strong>.</li>
</ol>
<p>This will bring you back to the CloudFormation console. You can refresh the stack set to see the latest status. Before moving on, make sure the stack finally shows <strong>CREATE_COMPLETE</strong>.</p>
<p>You will need to configure the <a href="https://aws.amazon.com/cli/" target="_blank"> AWS CLI </a> on your laptop or system of choice with credentials that allow at least IAM admin permissions for the <strong>Build</strong> phase. Then move on to <strong>Task 1</strong>.</p>
</details>
<hr />
<h3 id="_1"></h3>
<h2 id="task-1-create-the-webadmins-role">Task 1 <small>Create the webadmins role</small></h2>
<p>First you will create an IAM role for the webadmins (initially this role will trust your own AWS account but when you switch accounts with an another team in the <strong>Verify</strong> phase you will configure it to trust the other team's account):</p>
<ul>
<li>For many of the steps below you will need your account ID. To get that type in `aws sts get-caller-identity'. The account ID will be the first number listed after <strong>Account</strong>. (If you are using Cloud9, you can do this from a second terminal window so you can refer back to it later when needed.)</li>
<li>Use the following JSON to create a file named <strong><code>trustpolicy1.json</code></strong> for the trust policy (using your preferred text editor): </li>
</ul>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
  <span class="nt">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Principal&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;AWS&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID&gt;:root&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;sts:AssumeRole&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<ul>
<li>Create the IAM role that will be used by the webadmins:</li>
</ul>
<div class="codehilite"><pre><span></span>aws iam create-role --role-name webadmins --assume-role-policy-document file://trustpolicy1.json
</pre></div>


<ul>
<li>Attach the AWSLambdaReadOnlyAccess AWS Managed Policy to the role:</li>
</ul>
<div class="codehilite"><pre><span></span>aws iam attach-role-policy --policy arn:aws:iam::aws:policy/AWSLambdaReadOnlyAccess --role-name webadmins
</pre></div>


<h2 id="task-2-create-the-permissions-boundary-for-the-webadmins">Task 2 <small>Create the permissions boundary for the webadmins</small></h2>
<p>Next you will create the policy that will be used as the permissions boundary.  The permissions boundary should only allow the following actions: Create log groups, create log streams, put logs and list the files in the webadmins folder of the bucket that starts with <code>"shared-logging-"</code> and ends in <code>"-data"</code>:</p>
<ul>
<li>Use the following JSON to create a file named <strong><code>boundarydoc.json</code></strong> for the permissions boundary policy:</li>
</ul>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;CreateLogGroup&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;logs:CreateLogGroup&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:logs:us-east-1:&lt;ACCOUNT_ID&gt;:*&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;CreateLogStreamandEvents&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;logs:CreateLogStream&quot;</span><span class="p">,</span>
                <span class="s2">&quot;logs:PutLogEvents&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:logs:us-east-1:&lt;ACCOUNT_ID&gt;:log-group:/aws/lambda/*:*&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;AllowedS3GetObject&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;s3:List*&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:s3:::shared-logging-&lt;ACCOUNT_ID&gt;-us-east-1-data&quot;</span><span class="p">,</span>
             <span class="nt">&quot;Condition&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;StringEquals&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;s3:prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;webadmins&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>       
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<ul>
<li>Create the policy:</li>
</ul>
<div class="codehilite"><pre><span></span>aws iam create-policy --policy-name webadminspermissionsboundary --policy-document file://boundarydoc.json
</pre></div>


<div class="admonition question">
<p class="admonition-title">Question</p>
<ul>
<li>What will the webadmins attach the permissions boundary to?</li>
<li>How does a permissions boundary differ from a standard IAM policy?</li>
<li>How could you test the permissions boundary at this point?</li>
</ul>
</div>
<h2 id="task-3-create-the-permission-policy-for-the-webadmins">Task 3 <small>Create the permission policy for the webadmins</small></h2>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><strong>IMPORTANT!!!!</strong> - The question marks <strong><code>????</code></strong> in the policy below should be replaced with something that could act as part of a resource restriction.  The end result is that you will have a pathing requirement for the roles and policies. Replacing the <strong><code>????</code></strong> is one of the key challenges in this workshop and probably the most confusing part. Talk to a facilitator if you have issues with this. </p>
</div>
<p>Next you will create the policy that will be attached to the webadmins role.</p>
<ul>
<li>Use the following JSON to create a file named <strong><code>policydoc.json</code></strong> for the permission policy:</li>
</ul>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;CreateCustomerManagedPolicies&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;iam:CreatePolicy&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:DeletePolicy&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:CreatePolicyVersion&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:DeletePolicyVersion&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:SetDefaultPolicyVersion&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID&gt;:policy/webadmins/????&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
              <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;RoleandPolicyActionswithnoPermissionBoundarySupport&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;iam:UpdateRole&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;iam:DeleteRole&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID&gt;:role/webadmins/????&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;CreateRoles&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;iam:CreateRole&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:AttachRolePolicy&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:DetachRolePolicy&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID&gt;:role/webadmins/????&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Condition&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;StringEquals&quot;</span><span class="p">:</span> 
                <span class="p">{</span><span class="nt">&quot;iam:PermissionsBoundary&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID&gt;:policy/webadminspermissionsboundary&quot;</span><span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;LambdaFullAccess&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;lambda:*&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:lambda:us-east-1:&lt;ACCOUNT_ID&gt;:function:*&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;PassRoletoLambda&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;iam:PassRole&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID&gt;:role/webadmins/????&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Condition&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;StringLikeIfExists&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;iam:PassedToService&quot;</span><span class="p">:</span> <span class="s2">&quot;lambda.amazonaws.com&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;AdditionalPermissionsforLambda&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span>   <span class="p">[</span><span class="s2">&quot;kms:ListAliases&quot;</span><span class="p">,</span> <span class="s2">&quot;logs:Describe*&quot;</span><span class="p">,</span> <span class="s2">&quot;logs:ListTagsLogGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;logs:FilterLogEvents&quot;</span><span class="p">,</span> <span class="s2">&quot;logs:GetLogEvents&quot;</span><span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;DenyPermissionBoundaryandPolicyDeleteModify&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Deny&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;iam:CreatePolicyVersion&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:DeletePolicy&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:DeletePolicyVersion&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iam:SetDefaultPolicyVersion&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID&gt;:policy/webadminspermissionsboundary&quot;</span><span class="p">,</span>
                <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID&gt;:policy/webadminspermissionpolicy&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;DenyRolePermissionBoundaryDelete&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Deny&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;iam:DeleteRolePermissionsBoundary&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<ul>
<li>Create a policy named <code>webadminspermissionpolicy</code>:</li>
</ul>
<div class="codehilite"><pre><span></span>aws iam create-policy --policy-name webadminspermissionpolicy --policy-document file://policydoc.json
</pre></div>


<ul>
<li>Attach the policy to the webadmins role</li>
</ul>
<div class="codehilite"><pre><span></span>aws iam attach-role-policy --role-name webadmins --policy-arn arn:aws:iam::&lt;ACCOUNT_ID&gt;:policy/webadminspermissionpolicy
</pre></div>


<p>When you are done the <strong>webadmins</strong> role should have these two policies attached: <strong>webadminspermissionpolicy</strong> &amp; <strong>AWSLambdaReadOnlyAccess</strong>.</p>
<div class="admonition question">
<p class="admonition-title">Questions</p>
<ul>
<li>Why were there some blocks above in the policy that used the permissions boundary condition and some that did not?</li>
<li>Why are we using pathing here?</li>
<li>There are two ways of doing resource restrictions: naming and pathing. Which option allows you to create policies using both the AWS Console and CLI?</li>
<li>Why do we add the Deny for DeletePolicy actions regarding the webadminspermissionsboundary &amp; webadminspermissionpolicy?</li>
</ul>
</div>
<h2 id="task-4-test-the-webadmins-permissions">Task 4 <small>Test the webadmins permissions</small></h2>
<p>It's time to check your work and make sure the webadmins are set up properly. You need to test the following actions as the webadmins:</p>
<ol>
<li>Create an IAM policy</li>
<li>Create an IAM role (and attach that policy) </li>
<li>Create a Lambda function (and attach that role)</li>
</ol>
<p>The instructions for how to test the setup can be found in the <strong><a href="../verify/">VERIFY phase</a></strong>. The <strong>VERIFY</strong> phase assumes you are checking another team's setup but for your own testing this will be just done in your own account. You'll need to keep that in mind because some of the <strong>VERIFY</strong> phase instructions assume you are doing this cross account so you'll need to adjust some of the commands. </p>
<p>When you have verified your work is correct, move on to the next task (<strong>Task 5</strong>) which will involve actually exchanging information so another team can verify your work. </p>
<h2 id="task-5-gather-info-needed-for-the-verify-phase">Task 5 <small>Gather info needed for the <strong>VERIFY</strong> phase</small></h2>
<p>It is time to pass the work on to another team who will work through the <strong>VERIFY</strong> tasks. If you are doing this workshop online on your own then you already verified your work in <strong>Task 4</strong> so you can skip this task. </p>
<p>If you were given a form to fill out then enter the info and hand it to another team (or send this to the other team using whatever method is easiest.) If you followed the recommended naming conventions you only need to enter your <strong>Account ID</strong> and <strong>Resource restriction</strong>.</p>
<ul>
<li>Webadmins role ARN:   arn:aws:iam::<code>&lt;YOUR_ACCOUNT_ID&gt;</code>:role/<strong>webadmins</strong></li>
<li>Resource restriction for both the roles and policies: /webadmins/<code>Resource restriction you used</code></li>
<li>Permissions boundary name: <strong>webadminspermissionsboundary</strong></li>
<li>Permission policy name: <strong>webadminspermissionpolicy</strong></li>
</ul>
<p>Exchange forms with another team and then update the trust policy of the webadmins roles so the other team can assume the role (they will do the same for your team):</p>
<ul>
<li>Use the following JSON to create a file name <code>trustpolicy2.json</code> for the trust policy. Replace <code>&lt;YOUR_ACCOUNT_ID&gt;</code> with your Account ID so you can still retest this if needed and the <code>&lt;ACCOUNT_ID_FROM_OTHER_TEAM&gt;</code> with the other team's Account ID:</li>
</ul>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
  <span class="nt">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
      <span class="nt">&quot;Principal&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;AWS&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;arn:aws:iam::&lt;YOUR_ACCOUNT_ID&gt;:root&quot;</span><span class="p">,</span>
          <span class="s2">&quot;arn:aws:iam::&lt;ACCOUNT_ID_FROM_OTHER_TEAM&gt;:root&quot;</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;sts:AssumeRole&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<ul>
<li>Update the trust policy on the webadmins roles so both your team and the verify team can assume the role</li>
</ul>
<div class="codehilite"><pre><span></span>aws iam update-assume-role-policy --role-name webadmins --policy-document file://trustpolicy2.json
</pre></div>


<p><strong><a href="../verify/">Click here to go to the VERIFY phase</a></strong></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../" title="Scenario" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Scenario
              </span>
            </div>
          </a>
        
        
          <a href="../verify/" title="Verify Phase" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Verify Phase
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://awssecworkshops.com" class="md-footer-social__link fa fa-home"></a>
    
      <a href="https://aws.amazon.com/security/" class="md-footer-social__link fa fa-shield"></a>
    
      <a href="https://twitter.com/awssecurityinfo?lang=en" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://aws.amazon.com/blogs/security/" class="md-footer-social__link fa fa-rss"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>